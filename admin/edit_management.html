<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Editar Gestão</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="js/auth.js"></script>
</head>
<body class="bg-gray-50 p-8">
    <div class="max-w-4xl mx-auto">
        <h2 class="text-2xl font-bold mb-6">Equipe de Gestão</h2>
        <div id="managementList" class="space-y-4"></div>
    </div>

    <script>
        async function loadManagement() {
            const res = await fetch('http://localhost:3000/api/content/management');
            const members = await res.json();
            const container = document.getElementById('managementList');
            container.innerHTML = '';

            members.forEach(m => {
                container.innerHTML += `
                    <div class="bg-white p-4 rounded shadow flex items-center gap-4">
                        <img src="${m.image || 'https://via.placeholder.com/100'}" class="w-16 h-16 rounded-full object-cover border">
                        <div class="flex-1">
                            <p class="text-sm text-gray-500 font-bold uppercase">${m.role}</p>
                            <input type="text" id="name-${m._id}" value="${m.name}" class="border p-1 rounded w-full mt-1" placeholder="Nome">
                        </div>
                        <div class="flex-1">
                            <p class="text-xs text-gray-400">URL da Foto</p>
                            <input type="text" id="img-${m._id}" value="${m.image}" class="border p-1 rounded w-full mt-1 text-sm">
                        </div>
                        <button onclick="saveMember('${m._id}')" class="bg-blue-600 text-white px-4 py-2 rounded h-10 self-end">Salvar</button>
                    </div>
                `;
            });
        }

        async function saveMember(id) {
            const token = localStorage.getItem('token');
            const name = document.getElementById(`name-${id}`).value;
            const image = document.getElementById(`img-${id}`).value;

            await fetch(`http://localhost:3000/api/content/management/${id}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json', 'x-auth-token': token },
                body: JSON.stringify({ name, image })
            });
            alert('Atualizado!');
            loadManagement();
        }

        loadManagement();
    </script>
</body>
</html>